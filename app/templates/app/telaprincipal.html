{% extends 'app/base.html' %}
{% load static %}

{% block title %}Início - EstacionaFácil{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'telaPrincipal.css' %}" />
{% endblock %}

{% block content %}
<div class="container">
    <h1>Encontre o melhor lugar para estacionar o seu carro</h1>
    <h1>Bem-vindo à Simulação</h1>

    <button>Simular Agora</button>

    <div class="caixa">
        <img src="https://bynd.com.br/wp-content/uploads/2019/07/vagas-de-estacionamento.jpg" alt="Imagem de Simulação" style="max-width: 100%; height: auto;" />
    </div>

    <div id="notificacoes" class="caixa">
        <strong>Notificações:</strong>
        <ul id="notificacoes-lista"></ul>
    </div>

    <div class="caixa">
        <h3>Que tal simular em outro horário?</h3>
        <button>Ir para Simulador de Demanda</button>
    </div>

    <div id="avaliacoes" class="caixa">
        <h3>Últimas Avaliações adicionadas</h3>
        {% for avaliacao in ultimas_avaliacoes %}
            <div class="avaliacao">
                <strong>{{ avaliacao.usuario.username }}</strong> —
                <span>{{ avaliacao.estacionamento.nome }}</span> —
                <span class="estrelas">
                    {% with media=avaliacao.media_avaliacao %}
                        {% for i in "12345" %}
                            {% if forloop.counter <= media %}★{% else %}☆{% endif %}
                        {% endfor %}
                    {% endwith %}
                </span><br>
                {{ avaliacao.comentario }}
            </div>
        {% empty %}
            <div class="avaliacao">Nenhuma avaliação ainda.</div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block scripts %}
    <script>
        const notificacoes = [
            "Novo cenário de simulação disponível.",
            "Demanda atualizada com sucesso.",
            "Erro corrigido no modelo de previsão.",
            "Novo feedback recebido."
        ];

        let index = 0;
        setInterval(() => {
            if (index < notificacoes.length) {
                const li = document.createElement("li");
                li.textContent = notificacoes[index++];
                document.getElementById("notificacoes-lista").appendChild(li);
            }
        }, 2000);
    </script>
{% endblock %}